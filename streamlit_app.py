#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
PPFO v19.0 â€” Ù†Ø¸Ø§Ù… Ø±ÙŠØ§Ø¶ÙŠ Ù…ØªÙƒØ§Ù…Ù„ (Ù…ØµØ­Ø­ ØªØ±ØªÙŠØ¨ Ø§Ù„Ø¯ÙˆØ§Ù„)
"""

import streamlit as st
import math
import random
import time
from functools import lru_cache
from collections import Counter
import sys
import json
import os

# === Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ù…ÙƒØªØ¨Ø§Øª Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±ÙŠØ© ===
SYMPY_AVAILABLE = False
GMPY2_AVAILABLE = False

try:
    import sympy
    SYMPY_AVAILABLE = True
except Exception:
    SYMPY_AVAILABLE = False

try:
    import gmpy2
    GMPY2_AVAILABLE = True
    mpz = gmpy2.mpz
except Exception:
    GMPY2_AVAILABLE = False
    mpz = int

# === Ø§Ù„Ø«ÙˆØ§Ø¨Øª Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ© ===
EULER_GAMMA = 0.57721566490153286060651209008240243104215933593992

# === Ø£ØµÙØ§Ø± Ø²ÙŠØªØ§ (Ù‚ÙŠÙ… Ø¹Ø¯Ø¯ÙŠØ© ØªÙ‚Ø±ÙŠØ¨ÙŠØ© Ù„Ù„Ø£ØµÙØ§Ø± ØºÙŠØ±Ø§Ù„Ù…Ù†Ø·Ù‚ÙŠØ©) ===
RIEMANN_ZEROS = [
    14.1347251417347,21.0220396387716,25.0108575801457,30.4248761258595,32.9350615877392,37.5861781588257,40.9187190121475,43.327073280915,48.0051508811672,49.7738324776723,52.9703214777145,56.4462476970634,59.3470440026024,60.8317785246098,65.1125440480816,67.0798105294942,69.546401711174,72.0671576744819,75.7046906990839,77.1448400688748,79.3373750202494,82.910380854086,84.7354929805171,87.4252746131252,88.8091112076345,92.4918992705585,94.6513440405199,95.8706342282453,98.8311942181937,101.317851005731,103.725538040478,105.446623052326,107.168611184276,111.02953554317,111.874659176993,114.320220915453,116.226680320858,118.790782865976,121.370125002421,122.946829293553,124.256818554346,127.516683879596,129.578704199956,131.087688530933,133.497737202998,134.756509753374,138.116042054533,139.736208952121,141.123707404021,143.111845807621,146.000982486766,147.42276534256,150.053520420785,150.925257612241,153.024693811199,156.112909294238,157.597591817594,158.84998817142,161.188964137596,163.030709687182,165.5370691879,167.184439978175,169.094515415569,169.911976479412,173.411536519592,174.754191523366,176.44143429771,178.3774077761,179.916484020257,182.207078484366,184.874467848388,185.598783677707,187.228922583502,189.416158656017,192.026656360714,193.079726603846,195.265396679529,196.876481840958,198.015309676252,201.264751943704,202.493594514141,204.189671803105,205.394697202163,207.906258887806,209.576509716856,211.690862595365,213.347919359713,214.547044783491,216.169538508264,219.067596349021,220.714918839314,221.430705554693,224.007000254604,224.983324669582,227.421444279679,229.337413305525,231.250188700499,231.98723525318,233.693404178908,236.524229665816,237.7698204809252,239.5554775733276,241.0491577962166,242.8232719342226,244.0708984970782,247.1369900748975,248.1019900601485,249.5736896447072,251.014947795016,253.0699867479995,255.306256454914,256.3807136944345,258.6104394915314,259.874406989678,260.8050845045969,263.57389390487,265.5578518388763,266.6149737815011,267.9219150828241,269.9704490239976,271.494055641645,273.4596091884033,275.5874926493438,276.4520495031329,278.250743529842,279.2292509277452,282.4651147650521,283.2111857332339,284.8359639809047,286.6674453630029,287.9119205014222,289.5798549292188,291.8462913290674,293.5584341393563,294.9653696192655,295.5732548789583,297.9792770619434,299.8403260537213,301.6493254621942,302.6967495896069,304.8643713408573,305.7289126020368,307.2194961281701,310.1094631467019,311.165141530356,312.4278011806009,313.9852857311589,315.4756160894757,317.7348059423702,318.8531042563166,321.1601343091136,322.1445586724829,323.4669695575121,324.8628660517396,327.4439012619055,329.0330716804809,329.9532397282339,331.4744675826634,333.6453785248699,334.2113548332444,336.8418504283907,338.3399928508066,339.8582167253635,341.0422611110466,342.0548775103636,344.6617029402523,346.34787056601,347.2726775844205,349.3162608706961,350.4084193491921,351.8786490253593,353.4889004887188,356.017574977265,357.1513022520396,357.9526851016323,359.7437549531144,361.2893616958047,363.3313305789738,364.736024114089,366.2127102883313,367.9935754817403,368.9684380957344,370.050919212106,373.0619283721128,373.8648739109086,375.8259127667393,376.3240922306681,378.4366802499655,379.8729753465323,381.4844686171865,383.4435294495365,384.9561168148637,385.8613008459742,387.222890222388,388.8461283542323,391.456083563638,392.2450833395191,393.427743844434,395.5828700109937,396.3818542225922,544.3238901010053,545.6368332489348,547.0109120581223,547.9316133644893,549.4975675626614,550.9700100394839,552.0495722005649,553.7649721191588,555.7920205616825,556.8994764068554,557.5646591720585,559.3162370286822,560.2408074972957,562.5592076160459,564.1608791107861,564.5060559381498,566.698787682808,567.7317579011769,568.9239551796294,570.0511147824636,572.4199841324528,573.6146105267581,575.0938860144949,575.8072471409288,577.0390034720982,579.0988346720366,580.1369593623846,581.9465762659016,583.2360882191673,584.5617059034655,585.9845632049883,586.7427718912502,588.139663266248,590.6603975167653,591.7258580650481,592.5713583002256,593.974714682231,595.7281536973889,596.3627683283937,598.4930773461648,599.5456403643649,601.6021367359326,602.5791678863874,603.6256189035792,604.6162184937532,606.383460422109,608.4132173111873,609.3895751547201,610.8391629377394,611.7742096208872,613.5997786756371,614.6462378722326,615.538563369407,618.1128313664424,619.1844825979536,620.2728936722275,621.7092945279486,622.375002739779,624.2699000181779,626.0192834276544,627.268396850783,628.3258623594604,630.473887438292,630.8057809271975,632.225141167116,633.5468582522518,635.5238003106055,637.3971931598373,637.9255139808226,638.9279382668568,640.6947946688257,641.9454996657053,643.2788837813979,644.990578229748,646.3481915955016,647.7617530042889,648.7864008887824,650.1975193452565,650.668683891396,653.6495716053947,654.3019205863193,655.7094630223556,656.9640845994606,658.1756144186054,659.6638459729641,660.7167325952793,662.2965864311004,664.244604652273,665.342763095599,666.515147704173,667.1484948945554,668.9758488202351,670.3235852058626,672.4581835841697,673.0435782861476,674.3558978101232,676.1396743636267,677.230180668764,677.8004447462213,679.7421978825282,681.8949915331519,682.6027350197505,684.0135498138695,684.9726298620985,686.163223587728,687.9615431847036,689.3689413622724,690.4747350323504,692.4516844155208,693.1769700606018,694.5339086998731,695.7263359209267,696.6260699003456,699.1320954760135,700.2967391321435,701.3017429546462,702.2273431457605,704.0338392955253,705.1258139546192,706.1846547995179,708.2690708851099,709.2295885702843,711.1302741796854,711.9002899143753,712.7493834701013,714.0827718206694,716.1123964540521,717.4825697031002,718.7427865454859,719.6971009883657,721.3511622185364,722.2775049756742,723.8458210451284,724.5626138903791,727.0564032300494,728.4054815889341,728.7587497956143,730.4164821227564,731.4173549185985,732.8180527144998,734.789643252378,735.7654592085783,737.0529289122653,738.5804211713738,739.909523674042,740.573807447295,741.7573355729417,743.8950131424737,745.3449895506119,746.4993058994323,747.6745636242695,748.2427544650845,750.6559503621243,750.9663810666508,752.8876215672024,754.3223704717127,755.8393089760378,756.768248439951,758.1017292464126,758.9002382248924,760.2823669835121,762.7000332496911,763.5930661728372,764.3075227241802,766.0875400998362,767.2184721555395,768.2814618065092,769.6934072526244,771.0708393136783,772.961617565757,774.1177446279405,775.0478470965805,775.9997119631714,777.2997485295926,779.157076949189,780.3489250041817,782.1376643908121,782.5979439460735,784.2888226124655,785.7390897007151,786.4611474505063,787.46846381591,790.0590923641196,790.831620467921,792.4277076086045,792.8886525626226,794.4837918698932,795.6065961561624,797.2634700380356,798.7075701662962,799.6543362108976,801.6042464629821,802.5419848784181,803.2430962042702,804.7622391126618,805.8616356670948,808.1518149359937,809.1977833633007,810.0818048864071,811.1843588465063
]

# === Ù…Ø¹Ù„Ù…Ø§Øª Ø§Ù„Ù…Ø¹Ø§ÙŠØ±Ø© ===
_CAL_A = 0.02176304641727069
_CAL_B = -0.36685833943157
_CAL_C = 8.69441462116514

# === Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ© (Ù…Ø¹Ø±Ù‘ÙØ© Ù…Ø¨ÙƒØ±Ø§Ù‹) ===

@lru_cache(maxsize=2000)
def is_prime_fast(n: int) -> bool:
    """Ø§Ø®ØªØ¨Ø§Ø± Ø£ÙˆÙ„ÙŠØ© Ø³Ø±ÙŠØ¹ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ§Øª Ù…ØªØ¹Ø¯Ø¯Ø©"""
    n = int(n)
    if n < 2:
        return False
    if n in (2, 3, 5, 7, 11, 13):
        return True
    if n % 2 == 0:
        return False

    # Ø§Ø³ØªØ®Ø¯Ø§Ù… gmpy2 Ø¥Ø°Ø§ Ù…ØªÙˆÙØ±
    if GMPY2_AVAILABLE:
        try:
            return bool(gmpy2.is_prime(mpz(n)))
        except Exception:
            pass

    # Ø§Ø³ØªØ®Ø¯Ø§Ù… sympy Ø¥Ø°Ø§ Ù…ØªÙˆÙØ±
    if SYMPY_AVAILABLE:
        try:
            return bool(sympy.isprime(n))
        except Exception:
            pass

    # Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ© Miller-Rabin (Ù…Ø¬Ù…ÙˆØ¹Ø© Ù‚ÙˆØ§Ø¹Ø¯ Ø£ÙˆÙ„ÙŠØ© ÙƒØ§ÙÙØ© Ù„Ù„Ø£Ø¹Ø¯Ø§Ø¯ ØµØºÙŠØ±Ø©/Ù…ØªÙˆØ³Ø·Ø©)
    d, s = n - 1, 0
    while d % 2 == 0:
        d //= 2
        s += 1

    bases = [2, 3, 5, 7, 11, 13, 17, 19, 23, 29]
    for a in bases:
        if a % n == 0:
            continue
        x = pow(a, d, n)
        if x == 1 or x == n - 1:
            continue
        for _ in range(s - 1):
            x = (x * x) % n
            if x == n - 1:
                break
        else:
            return False
    return True

def simple_sieve(limit: int):
    """ØºØ±Ø¨Ø§Ù„ Ø¥Ø±Ø§ØªÙˆØ³ØªÙŠÙ†Ø³ Ù„Ù„Ø£Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØµØºÙŠØ±Ø©"""
    if limit < 2:
        return []
    sieve = bytearray(b"\x01") * (limit + 1)
    sieve[0:2] = b"\x00\x00"
    for p in range(2, int(limit**0.5) + 1):
        if sieve[p]:
            step = p
            start = p * p
            sieve[start:limit+1:step] = b"\x00" * (((limit - start) // step) + 1)
    return [i for i, v in enumerate(sieve) if v]

def _try_limit_break(start_time, timeout):
    """Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ù…Ù‡Ù„Ø© Ø§Ù„Ø²Ù…Ù†ÙŠØ©"""
    if timeout is None:
        return False
    return (time.time() - start_time) > timeout

def brent_rho(n: int, timeout=None):
    """Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ© Brent Rho Ù„Ù„Ø¹ÙˆØ§Ù…Ù„"""
    if n % 2 == 0:
        return 2
    if n <= 3:
        return None
    start = time.time()
    while True:
        if timeout and (time.time() - start) > timeout:
            return None
        y = random.randrange(2, n-1)
        c = random.randrange(1, n-1)
        m = random.randrange(1, min(n-1, 100))
        g = 1
        r = 1
        q = 1
        x = y
        while g == 1:
            if timeout and (time.time() - start) > timeout:
                return None
            x = y
            for _ in range(r):
                y = (pow(y, 2, n) + c) % n
            k = 0
            while k < r and g == 1:
                ys = y
                for _ in range(min(m, r - k)):
                    y = (pow(y, 2, n) + c) % n
                    diff = abs(x - y)
                    if diff == 0:
                        q = 0
                    else:
                        q = (q * diff) % n
                g = math.gcd(q, n)
                k += m
            r *= 2
        if g == n:
            # Ù…Ø­Ø§ÙˆÙ„Ø© Ø§ØµÙ„Ø§Ø­ Ø§Ù„Ø­Ø§Ù„Ø©
            while True:
                if timeout and (time.time() - start) > timeout:
                    return None
                ys = (pow(ys, 2, n) + c) % n
                g = math.gcd(abs(x - ys), n)
                if g > 1 and g < n:
                    break
                if g == n:
                    break
        if g is None or g == 1 or g == n:
            return None
        return g

def pollard_rho(n: int, timeout=None):
    """Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ© Pollard Rho Ù„Ù„Ø¹ÙˆØ§Ù…Ù„"""
    if n % 2 == 0:
        return 2
    if n % 3 == 0:
        return 3
    if n <= 3:
        return None
    start = time.time()
    while True:
        if timeout and (time.time() - start) > timeout:
            return None
        x = random.randrange(2, n-1)
        y = x
        c = random.randrange(1, n-1)
        d = 1
        while d == 1:
            if timeout and (time.time() - start) > timeout:
                return None
            x = (x*x + c) % n
            y = (y*y + c) % n
            y = (y*y + c) % n
            d = math.gcd(abs(x-y), n)
            if d == n:
                break
        if d is None or d == n:
            # ØªØ¹ÙŠÙŠÙ† Ù…Ø­Ø§ÙˆÙ„Ø© Ø¬Ø¯ÙŠØ¯Ø©
            continue
        if d > 1 and d < n:
            return d

def factorize(n: int, timeout=None, verbose=False):
    """ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¹Ø¯Ø¯ Ø¥Ù„Ù‰ Ø¹ÙˆØ§Ù…Ù„Ù‡ Ø§Ù„Ø£ÙˆÙ„ÙŠØ©"""
    n = int(n)
    res = []
    start_time = time.time()

    def _factor(n_local):
        nonlocal res
        if timeout and (time.time() - start_time) > timeout:
            raise TimeoutError()
        if n_local == 1:
            return
        if is_prime_fast(n_local):
            res.append(int(n_local))
            return

        # ÙØ­Øµ Ø§Ù„Ù‚ÙˆØ§Ø³Ù… Ø§Ù„ØµØºÙŠØ±Ø© Ø£ÙˆÙ„Ø§Ù‹
        small_primes = [2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97]
        for p in small_primes:
            if n_local % p == 0:
                while n_local % p == 0:
                    res.append(int(p))
                    n_local //= p
                if n_local == 1:
                    return
                return _factor(n_local)

        # Ø§Ø³ØªØ®Ø¯Ø§Ù… sympy ÙƒØ®ÙŠØ§Ø± Ø³Ø±ÙŠØ¹ Ø¥Ù† ØªÙˆÙØ±
        if SYMPY_AVAILABLE:
            try:
                if timeout and (time.time() - start_time) > timeout:
                    raise TimeoutError()
                fdict = sympy.factorint(n_local, multiple=False)
                for p, e in fdict.items():
                    res.extend([int(p)]*int(e))
                return
            except Exception:
                pass

        # Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ø³ØªØ®Ø¯Ø§Ù… Brend / Pollard Ù„Ø¹Ø¯Ø© Ù…Ø­Ø§ÙˆÙ„Ø§Øª
        for attempt in range(6):
            if timeout and (time.time() - start_time) > timeout:
                raise TimeoutError()
            remaining_time = None
            if timeout:
                remaining_time = max(0, timeout - (time.time() - start_time))
            d = brent_rho(n_local, timeout=remaining_time)
            if d is None or d == n_local:
                d = pollard_rho(n_local, timeout=remaining_time)
            if d is None or d == n_local:
                continue
            # Ù†Ø¬Ø­Ù†Ø§ ÙÙŠ Ø¥ÙŠØ¬Ø§Ø¯ Ø¹Ø§Ù…Ù„ ØºÙŠØ± ØªØ§ÙÙ‡
            _factor(d)
            _factor(n_local // d)
            return

        # Ø¥Ù† Ù„Ù… Ù†Ù†Ø¬Ø­ØŒ Ù†Ø¹ØªØ¨Ø± Ø§Ù„Ø¹Ø¯Ø¯ Ù†ÙØ³Ù‡ ÙƒØ¹Ø§Ù…Ù„ (Ø¬Ø²Ø¦ÙŠ)
        if is_prime_fast(n_local):
            res.append(int(n_local))
        else:
            res.append(int(n_local))

    try:
        _factor(n)
    except TimeoutError:
        if verbose:
            # Ù„Ø§ Ù†Ø³ØªØ¯Ø¹ÙŠ st.* Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…ÙƒØªØ¨Ø§Øª Ø¹Ø§Ø¯Ø©ØŒ Ù„ÙƒÙ† Ù‡Ù†Ø§ Ù†Ø³Ù…Ø­ Ø¨Ø§Ù„ØªØ­Ø°ÙŠØ± Ø§Ù„Ù…Ø¨Ø§Ø´Ø±
            try:
                st.warning("â±ï¸ ØªÙ… Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù…Ù‡Ù„Ø© Ø§Ù„ØªØ­Ù„ÙŠÙ„ â€” Ø¥Ø±Ø¬Ø§Ø¹ Ø§Ù„Ø¹ÙˆØ§Ù…Ù„ Ø§Ù„Ø¬Ø²Ø¦ÙŠØ© Ø§Ù„Ù…ÙƒØªØ´ÙØ©.")
            except Exception:
                pass
    return sorted(res)

def riemann_correction(estimate: int, zeros=None):
    """
    ØªØµØ­ÙŠØ­ ØªØ°Ø¨Ø°Ø¨ÙŠ ØªÙ‚Ø±ÙŠØ¨ÙŠ Ù…Ø³ØªÙˆØ­Ù‰ Ù…Ù† Ø§Ù„ØµÙŠØºØ© Ø§Ù„ØµØ±ÙŠØ­Ø©.
    ÙŠÙØ±Ø¬Ø¹ Ù‚ÙŠÙ…Ø© ØµØ­ÙŠØ­Ø© ØªÙ‚Ø±ÙŠØ¨ÙŠØ© (Ù‚Ø¯ ØªÙƒÙˆÙ† Ø³Ø§Ù„Ø¨Ø© Ø£Ùˆ Ù…ÙˆØ¬Ø¨Ø©).
    """
    if zeros is None:
        zeros = RIEMANN_ZEROS
    try:
        x = max(3, int(estimate))
        ln_x = math.log(x)
        s = 0.0
        for gamma in zeros:
            s += math.cos(gamma * ln_x) / math.sqrt(0.25 + gamma*gamma)
        correction = (math.sqrt(x) / max(1.0, ln_x)) * (s / (2.0 * math.pi))
        return int(round(correction))
    except Exception:
        return 0

def prime_nth_estimate(n: int, use_riemann=False):
    """
    ØªÙ‚Ø¯ÙŠØ± p_n Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… ØªÙ‚Ø±ÙŠØ¨ Ø±ÙŠÙ…Ø§Ù†-ÙÙˆÙ† Ù…Ø§Ù†ØºÙˆÙ„Øª + Ù…Ø¹Ø§Ù…Ù„ Ù…Ø¹Ø§ÙŠØ±Ø© Ù…ÙØ­Ø³Ù‘Ù† C(n).
    Ø¥Ø°Ø§ use_riemann=True ÙØ³Ù†Ø¶ÙŠÙ ØªØµØ­ÙŠØ­ Ø±ÙŠÙ…Ø§Ù† Ø§Ù„ØªØ®Ù…ÙŠÙ†ÙŠ Ù„ÙƒÙ† Ù†Ù‚ÙŠØ¯Ù‡ Ø¨Ù€ cap_fraction.
    """
    n = int(n)
    if n < 1:
        raise ValueError("n must be >= 1")
    if n < 6:
        return [2,3,5,7,11][n-1]

    ln_n = math.log(n)
    ln_ln_n = math.log(ln_n)

    # Ø§Ù„ØªÙ‚Ø±ÙŠØ¨ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ Ù…Ù† Riemannâ€“von Mangoldt
    base = ln_n + ln_ln_n - 1
    if n > 100:
        base += (ln_ln_n - 2) / ln_n
    if n > 1000:
        base -= EULER_GAMMA / ln_n

    # Ù…Ø¹Ø§Ù…Ù„ Ø§Ù„ØªØµØ­ÙŠØ­ Ø§Ù„Ù…ÙØ¹Ø§ÙŠÙØ±
    C_calibrated = _CAL_A + (_CAL_B / ln_n) + (_CAL_C / (ln_n ** 2))

    estimate = int(round(n * (base + C_calibrated)))

    if use_riemann:
        # Ù†Ø­Ø³Ø¨ ØªØµØ­ÙŠØ­ Ø±ÙŠÙ…Ø§Ù† Ø«Ù… Ù†Ù‚ÙŠØ¯Ù‡ (cap) Ø­ØªÙ‰ Ù†Ø³Ø¨Ø© ØµØºÙŠØ±Ø© Ù…Ù† estimate
        corr = riemann_correction(estimate)
        # cap fraction: 0.5% ÙƒØªÙ‚ÙŠÙŠØ¯ Ø§ÙØªØ±Ø§Ø¶ÙŠ
        cap_fraction = 0.005
        cap = max(10, int(cap_fraction * estimate))
        corr = max(-cap, min(cap, corr))
        estimate += corr

    return int(estimate)

# === ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (Streamlit) ===

st.set_page_config(
    page_title="PPFO v19.0 - ØªØ­Ù„ÙŠÙ„ Ø±ÙŠØ§Ø¶ÙŠ Ù…ØªÙ‚Ø¯Ù…",
    page_icon="ğŸ§®",
    layout="wide",
    initial_sidebar_state="expanded"
)

# === ØªØµÙ…ÙŠÙ… CSS Ù…Ø®ØµØµ ===
st.markdown("""
<style>
    .main-header {
        font-size: 2.5rem;
        font-weight: bold;
        color: #2c3e50;
        text-align: center;
        margin-bottom: 1.5rem;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
    }
    .section-header {
        font-size: 1.5rem;
        font-weight: bold;
        color: #3498db;
        margin-top: 1.5rem;
        margin-bottom: 1rem;
        border-bottom: 2px solid #3498db;
        padding-bottom: 0.5rem;
    }
    .info-box {
        background-color: #f8f9fa;
        border-left: 4px solid #3498db;
        padding: 1rem;
        margin: 1rem 0;
        border-radius: 0 8px 8px 0;
    }
    .success-box {
        background-color: #d4edda;
        border-left: 4px solid #28a745;
        padding: 1rem;
        margin: 1rem 0;
        border-radius: 0 8px 8px 0;
    }
    .error-box {
        background-color: #f8d7da;
        border-left: 4px solid #dc3545;
        padding: 1rem;
        margin: 1rem 0;
        border-radius: 0 8px 8px 0;
    }
    .warning-box {
        background-color: #fff3cd;
        border-left: 4px solid #ffc107;
        padding: 1rem;
        margin: 1rem 0;
        border-radius: 0 8px 8px 0;
    }
    .result-box {
        background-color: #e3f2fd;
        border: 2px solid #2196f3;
        padding: 1.5rem;
        border-radius: 10px;
        margin: 1rem 0;
    }
    .math-formula {
        font-family: 'Cambria Math', 'Times New Roman', serif;
        font-size: 1.2rem;
        color: #e74c3c;
        background-color: #f9f9f9;
        padding: 0.5rem;
        border-radius: 5px;
        margin: 0.5rem 0;
    }
</style>
""", unsafe_allow_html=True)

# === Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ ===
st.markdown('<p class="main-header">ğŸ§® PPFO v19.0</p>', unsafe_allow_html=True)
st.markdown("### ØªØ­Ù„ÙŠÙ„ Ø±ÙŠØ§Ø¶ÙŠ Ù…ØªÙ‚Ø¯Ù… Ù„Ù„Ø£Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø£ÙˆÙ„ÙŠØ© ÙˆØ§Ù„Ø¹ÙˆØ§Ù…Ù„")

# === Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ ===
with st.sidebar:
    st.image("https://via.placeholder.com/150x50?text=PPFO+Logo", use_column_width=True)
    st.markdown("### ğŸ“š Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©")

    menu = st.radio(
        "Ø§Ù„ØªÙ†Ù‚Ù„",
        ["ğŸ  Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©", "ğŸ” ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¹ÙˆØ§Ù…Ù„", "ğŸ“Š ØªÙ‚Ø¯ÙŠØ± Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø£ÙˆÙ„ÙŠØ©", "âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª", "â“ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©"],
        index=0
    )

    st.markdown("---")
    st.markdown("### ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø¬Ù„Ø³Ø©")

    if 'analysis_count' not in st.session_state:
        st.session_state.analysis_count = 0
        st.session_state.total_time = 0.0
        st.session_state.last_analysis = None
        st.session_state.use_riemann = False
        st.session_state.timeout = 60
        st.session_state.verbose = True

    st.metric("Ø¹Ø¯Ø¯ Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª", st.session_state.analysis_count)
    st.metric("Ù…ØªÙˆØ³Ø· Ø§Ù„ÙˆÙ‚Øª", f"{st.session_state.total_time/(st.session_state.analysis_count or 1):.2f} Ø«Ø§Ù†ÙŠØ©")

    if st.session_state.last_analysis:
        st.markdown(f"**Ø¢Ø®Ø± ØªØ­Ù„ÙŠÙ„:** {st.session_state.last_analysis}")

    st.markdown("---")
    st.markdown(f"**Ø§Ù„Ø¥ØµØ¯Ø§Ø±:** 19.0")
    st.markdown(f"**Ø§Ù„ØªØ§Ø±ÙŠØ®:** {time.strftime('%Y-%m-%d')}")
    st.markdown(f"**SymPy:** {'Ù…ØªÙˆÙØ±' if SYMPY_AVAILABLE else 'ØºÙŠØ± Ù…ØªÙˆÙØ±'}")
    st.markdown(f"**GMPY2:** {'Ù…ØªÙˆÙØ±' if GMPY2_AVAILABLE else 'ØºÙŠØ± Ù…ØªÙˆÙØ±'}")

# === Ø¨Ù‚ÙŠØ© Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© (Ø§Ù„ØµÙØ­Ø§ØªØŒ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¹ÙˆØ§Ù…Ù„ØŒ ØªÙ‚Ø¯ÙŠØ± Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø£ÙˆÙ„ÙŠØ©ØŒ ... ) ===
# ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø´ÙŠÙØ±Ø© Ù…Ù† Ù…Ù„ÙÙƒ Ø§Ù„Ø£ØµÙ„ÙŠ ÙƒÙ…Ø§ Ù‡ÙŠ Ø£Ø³ÙÙ„ Ù‡Ø°Ø§ Ø§Ù„Ø³Ø·Ø±
# (ØªÙ… Ø§Ø®ØªØµØ§Ø±Ù‡Ø§ Ù‡Ù†Ø§ ÙÙ‚Ø· Ù„Ø¹Ø¯Ù… ØªÙƒØ±Ø§Ø± Ù†ÙØ³ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø·ÙˆÙŠÙ„).
#
# Ù…Ù„Ø§Ø­Ø¸Ø©: ØªØ£ÙƒØ¯ ÙÙ‚Ø· Ù…Ù† Ø£Ù† Ø£ÙŠ Ø§Ø³ØªØ¯Ø¹Ø§Ø¡Ø§Øª Ù…Ø«Ù„ factorize(...) Ø£Ùˆ prime_nth_estimate(...)
# ØªØ­Ø¯Ø« Ø¨Ø¹Ø¯ ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø¯ÙˆØ§Ù„ â€” ÙˆÙ‡Ùˆ Ø­Ø§ØµÙ„ Ø§Ù„Ø¢Ù†.
#
# Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ØªØ­Ø³ÙŠÙ†.
